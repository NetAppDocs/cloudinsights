---
sidebar: sidebar
permalink: task_config_telegraf_kubernetes.html
keywords: telegraf
summary: Data collector for Kubernetes
---

= Data Collector: Kubernetes
:hardbreaks:
:toclevels: 1
:nofooter:
:icons: font
:linkattrs:
:imagesdir: ./media/

[.lead]
Cloud Insights uses this data collector to gather Kubernetes Pod, Node, and Container metrics. 


== Installation


For Kubernetes Installation instructions, please see the link:task_config_telegraf_agent_k8s.html[Kubernetes Monitoring Operator] page.


== About Kube-state-metrics

The Kubernetes Monitoring Operator installs kube-state-metrics automatically; no user interaction is needed.

=== kube-state-metrics Counters

Use the following links to access information for these kube state metrics counters:

. https://github.com/kubernetes/kube-state-metrics/blob/master/docs/configmap-metrics.md[ConfigMap Metrics]
. https://github.com/kubernetes/kube-state-metrics/blob/master/docs/daemonset-metrics.md[DaemonSet Metrics]
. https://github.com/kubernetes/kube-state-metrics/blob/master/docs/deployment-metrics.md[Deployment Metrics]
. https://github.com/kubernetes/kube-state-metrics/blob/master/docs/ingress-metrics.md[Ingress Metrics]
. https://github.com/kubernetes/kube-state-metrics/blob/master/docs/namespace-metrics.md[Namespace Metrics]
. https://github.com/kubernetes/kube-state-metrics/blob/master/docs/node-metrics.md[Node Metrics]
. https://github.com/kubernetes/kube-state-metrics/blob/master/docs/persistentvolume-metrics.md[Persistent Volume Metrics]
. https://github.com/kubernetes/kube-state-metrics/blob/master/docs/persistentvolumeclaim-metrics.md[Persistant Volume Claim Metrics]
. https://github.com/kubernetes/kube-state-metrics/blob/master/docs/pod-metrics.md[Pod Metrics]
. https://github.com/kubernetes/kube-state-metrics/blob/master/docs/replicaset-metrics.md[ReplicaSet metrics]
. https://github.com/kubernetes/kube-state-metrics/blob/master/docs/secret-metrics.md[Secret metrics]
. https://github.com/kubernetes/kube-state-metrics/blob/master/docs/service-metrics.md[Service metrics]
. https://github.com/kubernetes/kube-state-metrics/blob/master/docs/statefulset-metrics.md[StatefulSet metrics]


'''

////
== Objects and Counters

The following objects and their counters are collected:

[cols="<.<,<.<,<.<,<.<"]
|===
|Object:|Identifiers:|Attributes: |Datapoints:

|Kubernetes Container

|Namespace
Pod
Container
Cluster

|Kubernetes Node
Node Name
Node OS
Node UUID
Node IP


|CPU Nanoseconds
CPU Usage Nanocores
Memory Major Page Faults
Memory Resident Set Size (RSS)
Memory Working Set
Memory Page Faults
Memory Usage
Root Filesystem Available
Root Filesystem Capacity
Root Filesystem Used

|Kubernetes Node

|Kubernetes Node
Cluster

|Node Name
Node OS
Node UUID
Node IP

|CPU Usage Nanocores
CPU Usage Nanoseconds
Filesystem Available
Filesystem Total
Filesystem Used
Memory Available
Memory Usage 
Memory Major Page Faults
Memory Page Faults
Memory Resident Set Size (RSS)
Memory Working Set
Network RX Errors (per sec)
Network RX Bytes (per sec)
Network TX Errors (per sec)
Network TX Bytes (per sec)
Runtime Image Filesystem Available
Runtime Image Filesystem Used
Runtime Image Filesystem Capacity 

|Kubernetes Pod

|Namespace
Pod
Cluster

|Kubernetes Node
Node Name
Node IP
Node OS
Node UUID

|Network TX Bytes (per sec)
Network TX Errors (per sec)
Network RX Bytes (per sec)
Network RX Errors (per sec)

|Kubernetes Pod Volume
|Volume
Pod
Cluster
Namespace
|Kubernetes Node
Node Name
Node UUID
Node IP
Node OS

|Available
Capacity
Used

|Kubernetes System Container

|System Container 
Kubernetes Node 
Cluster

|Node Name 
Node IP 
Node OS 
Node UUID

|CPU Usage Nanocores 
CPU Usage Core Nanoseconds 
Memory Major Page Faults 
Memory Page Faults 
Memory Resident Set Size (RSS) 
Memory Usage 
Memory Working Set 
Root Filesystem Available 
Root Filesystem Capacity 
Logs Filesystem Available 
Logs Filesystem Capacity

|===
////


////
== Troubleshooting

[cols=2*, options="header", cols"50,50"]
|===
|Problem:|Try this:
|I ran the Kubernetes agent installer command, but I do not see a Telegraf agent pod running via:

 sudo kubectl --namespace ci-monitoring get pods

|Check if there were any errors deploying the DaemonSet:

 sudo kubectl --namespace ci-monitoring describe ds telegraf-ds

If there are errors related to SecurityContextConstraints, do the following:

1. Generate the Telegraf DaemonSet YAML

 sudo kubectl --namespace ci-monitoring get ds telegraf-ds -o yaml > /tmp/telegraf-ds.yaml

2. Stop the Telegraf service

 sudo kubectl --namespace ci-monitoring delete ds telegraf-ds

3. Create the necessary SecurityContextConstraint (see "Configuring Agent to Collect Data" section)

4. Re-create the Telegraf DaemonSet
|I configured Telegraf to obtain information about my Kubernetes cluster, but I don't see any information in Cloud Insights. I see "invalid header field value" errors in the Telegraf log file pertaining to the kubernetes input plugin I configured. 
|Ensure the referenced bearer_token file does not have a trailing newline. To verify, run the following command, and confirm that it returns 0: 

 tail -c1 <bearer_token_file> |wc -l
 
|===

Additional information may be found from the link:concept_requesting_support.html[Support] page.
////
